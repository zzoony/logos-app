<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sentence Analysis Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <!-- 헤더 -->
    <header class="header">
      <h1>Sentence Analysis Dashboard <span class="version-badge">v0.1.0</span></h1>
      <div class="header-status">
        <span class="status-badge" id="headerBibleVersion">ESV</span>
        <span class="status-badge method" id="headerAnalysisMethod">API</span>
      </div>
    </header>

    <!-- 탭 네비게이션 -->
    <nav class="tab-nav">
      <button class="tab-btn active" data-tab="analyze">분석</button>
      <button class="tab-btn" data-tab="validate">검증</button>
      <button class="tab-btn" data-tab="settings">설정</button>
    </nav>

    <!-- 분석 탭 컨텐츠 -->
    <div class="tab-content" id="analyzeTab" style="display: block;">

      <!-- 통계 개요 카드 -->
      <div class="stats-overview">
        <div class="stat-card">
          <div class="stat-icon primary">
            <span>📊</span>
          </div>
          <div class="stat-content">
            <div class="value" id="totalSentences">0</div>
            <div class="label">전체 문장</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon success">
            <span>✓</span>
          </div>
          <div class="stat-content">
            <div class="value" id="completedSentences">0</div>
            <div class="label">분석 완료</div>
            <div class="change positive" id="progressPercent">0%</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon warning">
            <span>⏳</span>
          </div>
          <div class="stat-content">
            <div class="value" id="pendingSentences">0</div>
            <div class="label">대기 중</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon danger">
            <span>!</span>
          </div>
          <div class="stat-content">
            <div class="value" id="failedSentences">0</div>
            <div class="label">실패</div>
          </div>
        </div>
      </div>

      <!-- 전체 진행도 -->
      <div class="card">
        <div class="progress-section">
          <h2>📈 전체 진행도</h2>
          <div class="progress-bar">
            <div class="progress-fill" id="overallProgress" style="width: 35%;"></div>
          </div>
          <div class="progress-stats">
            <span class="progress-text">완료: <strong id="completedVerses">10,885</strong> / 전체: <strong id="totalVerses">31,102</strong> 구절</span>
            <span class="progress-percentage" id="overallProgressText">35%</span>
          </div>
        </div>
      </div>

      <!-- 필터 및 컨트롤 -->
      <div class="card">
        <div class="controls">
          <div class="filter-buttons">
            <button class="filter-btn active" data-filter="all">전체</button>
            <button class="filter-btn" data-filter="old">구약 (39권)</button>
            <button class="filter-btn" data-filter="new">신약 (27권)</button>
          </div>
          <div class="control-buttons">
            <button class="btn btn-secondary" id="selectAllBtn">전체 선택</button>
            <button class="btn btn-secondary" id="deselectAllBtn">선택 해제</button>
            <button class="btn btn-secondary" id="refreshBtn">새로고침</button>
          </div>
        </div>
      </div>

      <!-- 성경 카드 그리드 -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">📚 성경 책 목록</h3>
          <span class="text-muted" id="selectedCount">0권 선택됨</span>
        </div>
        <div class="books-grid" id="booksGrid">
          <!-- 동적으로 생성됨 -->
        </div>
      </div>

      <!-- 선택 정보 및 실행 버튼 -->
      <div class="card">
        <div class="action-panel">
          <div class="selection-info">
            <div class="selection-text" id="selectionText">2권 선택됨 (2,746 구절)</div>
            <div class="estimate-text" id="estimateText">예상 소요 시간: 약 15분</div>
          </div>

          <div class="batch-size-control">
            <label for="batchSizeInput">동시 배치 개수:</label>
            <input type="number" id="batchSizeInput" min="1" max="50" value="4" />
            <span class="batch-size-hint" id="batchSizeHint">(기본값: 4, 범위: 1-50)</span>
          </div>

          <div class="action-buttons">
            <button class="btn btn-secondary btn-large" id="analyzeFileSelectBtn">파일 선택</button>
            <button class="btn btn-primary btn-large" id="startBtn">분석 시작</button>
            <button class="btn btn-warning btn-large hidden" id="retryFailedBtn">실패 재시도</button>
            <button class="btn btn-danger btn-large hidden" id="cancelBtn">중단</button>
          </div>
        </div>
      </div>

      <!-- 분석 진행 패널 -->
      <div class="card hidden" id="analysisPanel">
        <div class="analysis-panel">
          <h3>분석 진행 중...</h3>

          <div class="current-batch">
            <p id="analysisStatus">준비 중...</p>
            <div class="progress-bar">
              <div class="progress-fill" id="analysisProgressFill" style="width: 0%;"></div>
            </div>
          </div>

          <div class="analysis-stats">
            <div class="stat">
              <span class="stat-label">현재 책</span>
              <span class="stat-value" id="currentBook">-</span>
            </div>
            <div class="stat">
              <span class="stat-label">진행률</span>
              <span class="stat-value" id="currentProgress">0%</span>
            </div>
            <div class="stat">
              <span class="stat-label">완료</span>
              <span class="stat-value success" id="completedCount">0</span>
            </div>
            <div class="stat">
              <span class="stat-label">처리 중</span>
              <span class="stat-value warning" id="processingCount">10</span>
            </div>
            <div class="stat">
              <span class="stat-label">대기</span>
              <span class="stat-value" id="waitingCount">693</span>
            </div>
            <div class="stat">
              <span class="stat-label">실패</span>
              <span class="stat-value danger" id="failedCount">0</span>
            </div>
          </div>

          <div class="recent-completions">
            <h4>현재 진행중 (Pool: <span id="currentPoolDisplay">4</span>)</h4>
            <ul id="processingList">
              <!-- 동적으로 생성됨 -->
            </ul>
          </div>
        </div>
      </div>

    </div>
    <!-- 분석 탭 끝 -->

    <!-- 검증 탭 -->
    <div class="tab-content" id="validateTab" style="display: none;">

      <!-- 검증 통계 개요 -->
      <div class="stats-overview">
        <div class="stat-card">
          <div class="stat-icon primary">
            <span>📋</span>
          </div>
          <div class="stat-content">
            <div class="value" id="validateTotalVerses">0</div>
            <div class="label">검증 대상</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon success">
            <span>✓</span>
          </div>
          <div class="stat-content">
            <div class="value" id="validatePassedVerses">0</div>
            <div class="label">통과</div>
            <div class="change positive" id="validatePassRate">0%</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon warning">
            <span>⚠</span>
          </div>
          <div class="stat-content">
            <div class="value" id="validateIssueCount">0</div>
            <div class="label">이슈 발견</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon danger">
            <span>✗</span>
          </div>
          <div class="stat-content">
            <div class="value" id="validateFailedVerses">0</div>
            <div class="label">실패</div>
          </div>
        </div>
      </div>

      <!-- 검증 실행 패널 -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">🔍 검증 실행</h3>
        </div>
        <div class="action-panel">
          <div class="selection-info">
            <div class="selection-text" id="validateSelectionText">책을 선택하세요</div>
            <div class="estimate-text" id="validateEstimateText">분석 완료된 구절만 검증됩니다</div>
          </div>

          <div class="action-buttons">
            <button class="btn btn-secondary btn-large" id="validateSelectAllBtn">전체 선택</button>
            <button class="btn btn-primary btn-large" id="startValidationBtn">검증 시작</button>
          </div>
        </div>
      </div>

      <!-- 검증 대상 책 목록 -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">📚 검증 대상</h3>
          <span class="text-muted" id="validateSelectedCount">0권 선택됨</span>
        </div>
        <div class="books-grid" id="validateBooksGrid">
          <!-- 동적으로 생성됨 -->
        </div>
      </div>

      <!-- 검증 진행 패널 -->
      <div class="card hidden" id="validationPanel">
        <div class="analysis-panel">
          <h3>검증 진행 중...</h3>

          <div class="current-batch">
            <p id="validationStatus">준비 중...</p>
            <div class="progress-bar">
              <div class="progress-fill" id="validationProgressFill" style="width: 0%;"></div>
            </div>
          </div>

          <div class="analysis-stats">
            <div class="stat">
              <span class="stat-label">현재 책</span>
              <span class="stat-value" id="validateCurrentBook">-</span>
            </div>
            <div class="stat">
              <span class="stat-label">진행률</span>
              <span class="stat-value" id="validateCurrentProgress">0%</span>
            </div>
            <div class="stat">
              <span class="stat-label">통과</span>
              <span class="stat-value success" id="validateValidCount">0</span>
            </div>
            <div class="stat">
              <span class="stat-label">이슈</span>
              <span class="stat-value warning" id="validateIssuesFound">0</span>
            </div>
          </div>
        </div>
      </div>

      <!-- 검증 결과 패널 -->
      <div class="card hidden" id="validationResultsPanel">
        <div class="card-header">
          <h3 class="card-title">📊 검증 결과</h3>
          <button class="btn btn-secondary" id="exportReportBtn">리포트 내보내기</button>
        </div>

        <!-- 이슈 유형별 탭 -->
        <div class="issue-tabs">
          <button class="issue-tab-btn active" data-issue="all">전체</button>
          <button class="issue-tab-btn" data-issue="source_mismatch">원문 불일치</button>
          <button class="issue-tab-btn" data-issue="sentence_merge_mismatch">구문 합치기 오류</button>
          <button class="issue-tab-btn" data-issue="empty_translation">빈 번역</button>
          <button class="issue-tab-btn" data-issue="non_korean_chars">비한글 문자</button>
          <button class="issue-tab-btn" data-issue="english_in_korean">영어 포함</button>
        </div>

        <!-- 선택 툴바 -->
        <div class="issue-toolbar" id="issueToolbar" style="display: none;">
          <div class="toolbar-left">
            <label class="select-all-label">
              <input type="checkbox" id="selectAllIssues" />
              <span>전체 선택</span>
            </label>
            <span class="selected-count" id="selectedCount">0개 선택됨</span>
          </div>
          <div class="toolbar-right">
            <button class="btn-reanalyze-selected" id="reanalyzeSelectedBtn" disabled>
              선택 항목 재분석
            </button>
          </div>
        </div>

        <!-- 이슈 목록 -->
        <div class="issue-list" id="issueList">
          <!-- 동적으로 생성됨 -->
        </div>
      </div>

    </div>

    <!-- 설정 탭 -->
    <div class="tab-content" id="settingsTab" style="display: none;">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">📖 성경 버전 선택</h3>
        </div>
        <div class="card-body">
          <p class="setting-description">분석에 사용할 성경 버전을 선택하세요. 선택한 버전의 JSON 파일이 분석 소스로 사용됩니다.</p>

          <div class="bible-version-selector">
            <label class="version-option">
              <input type="radio" name="bibleVersion" value="ESV" checked>
              <div class="version-card">
                <div class="version-name">ESV</div>
                <div class="version-full">English Standard Version</div>
                <div class="version-file">ESV_Bible.json</div>
              </div>
            </label>

            <label class="version-option">
              <input type="radio" name="bibleVersion" value="NIV">
              <div class="version-card">
                <div class="version-name">NIV</div>
                <div class="version-full">New International Version</div>
                <div class="version-file">NIV_Bible.json</div>
              </div>
            </label>
          </div>

          <div class="current-setting">
            <span class="setting-label">현재 선택:</span>
            <span class="setting-value" id="currentVersionDisplay">ESV</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title">📁 소스 파일 경로</h3>
        </div>
        <div class="card-body">
          <div class="path-display">
            <span class="path-label">Source Data:</span>
            <code class="path-value" id="sourcePathDisplay">source-data/ESV_Bible.json</code>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title">🤖 분석 방법 선택</h3>
        </div>
        <div class="card-body">
          <p class="setting-description">구문 분석에 사용할 방법을 선택하세요. 각 방법마다 동시 실행 개수가 다릅니다.</p>

          <div class="bible-version-selector">
            <label class="version-option">
              <input type="radio" name="analysisMethod" value="api" checked>
              <div class="version-card">
                <div class="version-name">Z.AI API</div>
                <div class="version-full">glm-4.6 모델</div>
                <div class="version-file">동시 실행: 4개</div>
              </div>
            </label>

            <label class="version-option">
              <input type="radio" name="analysisMethod" value="claude">
              <div class="version-card">
                <div class="version-name">Claude CLI</div>
                <div class="version-full">Haiku 모델</div>
                <div class="version-file">동시 실행: 40개</div>
              </div>
            </label>

            <label class="version-option">
              <input type="radio" name="analysisMethod" value="droid">
              <div class="version-card">
                <div class="version-name">Droid Exec</div>
                <div class="version-full">glm-4.6 모델</div>
                <div class="version-file">동시 실행: 40개</div>
              </div>
            </label>
          </div>

          <div class="current-setting">
            <span class="setting-label">현재 선택:</span>
            <span class="setting-value" id="currentMethodDisplay">Z.AI API</span>
            <span class="setting-value" id="currentPoolSize" style="margin-left: 20px;">동시 실행: 4개</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title">🖥️ 에디터 선택</h3>
        </div>
        <div class="card-body">
          <p class="setting-description">검증 결과를 열 때 사용할 에디터를 선택하세요. 검증 탭에서 이슈를 더블클릭하면 해당 파일이 선택한 에디터에서 열립니다.</p>

          <div class="bible-version-selector">
            <label class="version-option">
              <input type="radio" name="editorChoice" value="cursor" checked>
              <div class="version-card">
                <div class="version-name">Cursor</div>
                <div class="version-full">Cursor Editor</div>
                <div class="version-file">cursor://</div>
              </div>
            </label>

            <label class="version-option">
              <input type="radio" name="editorChoice" value="antigravity">
              <div class="version-card">
                <div class="version-name">Antigravity</div>
                <div class="version-full">Antigravity Editor</div>
                <div class="version-file">antigravity://</div>
              </div>
            </label>
          </div>

          <div class="current-setting">
            <span class="setting-label">현재 선택:</span>
            <span class="setting-value" id="currentEditorDisplay">Cursor</span>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="renderer.js"></script>
</body>
</html>
